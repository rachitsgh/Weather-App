var Domain  = require("../lib/Domain"),
	  Builder  =  require("../lib/Builder");
	  

describe("Domain",function(){

	var db = {
		save:function(){}
	}

	var builder = new Builder();
	
	builder.bindDB(db);
	
	builder.bindService("service01",function(name){
		console.log(name);
	});
	
	builder.bindAggreType("Aggre01",function(data){return data;},{changeName:function(name){
	
		this.$data("name","leo");
		this.$publish("event02");
	
	}});

	builder.bindCommandHandle("commandhandle01",function(){
		var AT = this.$getAggreType("Aggre01");
		var o = new AT({name:"leo"});
		o.changeName("oel");
	});
	
	var domain = new Domain(builder);
	domain.on("event02",function(){
		console.log('OK !! GOOD!!');
	});
	
	domain.exec("commandhandle01")
	domain.exec("commandhandle01")
	
})